<link rel="import" href="bower_components/polymer/polymer.html">

<dom-module id="v-license-dialog">
    <style>

        :host {
            position: fixed;
            height: 100%;
            width: 100%;
            left: 0;
            top: 0;
            z-index: 10000;
            background-color: black;
            opacity: 0.72;
        }

        #v-license-dialog {
            position: fixed;
            width: 20%;
            left: 0;
            right: 0;
            top: 20%;
            margin: 0 auto;
            z-index: 20000;
            background-color: white;

        }

        #v-license-dialog {
            border: 1px solid black;
        }

        #v-license-dialog-header {
            color: black;
            background-color: white;
            border-bottom: 1px solid black;
        }

        #v-license-dialog-header #v-license-dialog-close {
            cursor: pointer;
            float: right;
        }

        #licenseDialogExplanation {

        }
    </style>
    <template>
        <div class="modality-curtain">
            <div id="v-license-dialog">
                <div id="v-license-dialog-header"><span>[[header]]</span><span id="v-license-dialog-close"
                                                                               on-click="_close">X</span></div>
                <div id="licenseDialogExplanation"></div>
                <div id="v-license-dialog-input">
                    <input id="licenseDialogInput" type="text"/>
                    <button on-click="_submit">Submit</button>
                </div>
            </div>
        </div>
    </template>
</dom-module>

<script>
    LicenseDialog = Polymer({
        is: "v-license-dialog",

        headers: {
            unlicensed: "Unlicensed copy of Vaadin %s",
            trial: "Vaadin %s trial license",
            expired: "Vaadin %s license expired"
        },

        contents: {
            unlicensed: 'To use Vaadin %s in development, each developer needs to have a valid license. Please <a href="https://vaadin.com/pro/licenses" target="_blank"> get a license from vaadin.com</a>, then enter your license key here:',
            trial: 'You are currently using Vaadin %s with a trial license, which will expire in %d days. You can <a href="https://vaadin.com/pro/licenses" target="_blank"> visit vaadin.com to get a paid license</a>, then enter your license key here:',
            expired: 'Your Vaadin %s license has expired. Please <a href="https://vaadin.com/pro/licenses" target="_blank">renew your license at vaadin.com</a>, then refresh the page. Alternatively, if you have a new license key, you can enter it here:'
        },

        properties: {
            type: String,
            productName: String,
            header: {
                type: String,
                computed: '_computeHeader(type, productName)'
            },
            content: {
                type: String,
                observer: '_contentChanged',
                computed: '_computeContent(type, productName)'
            }
        },

        factoryImpl: function (type, productName) {
            this.type = type;
            this.productName = productName;
        },

        _contentChanged: function (value) {
            this.$.licenseDialogExplanation.innerHTML = value;
        },

        _submit: function () {
            this.fire('v-license-dialog-submit', {licenseKey: this.$.licenseDialogInput.value});
            this.remove();
        },

        _close: function () {
            this.fire('v-license-dialog-close', {type: this.type});
            this.remove();
        },

        _computeHeader: function (type, productName) {
            return this.headers[type].replace(/%s/, productName);
        },

        _computeContent: function (type, productName) {
            return this.contents[type].replace(/%s/, productName);

        }

    });
</script>
